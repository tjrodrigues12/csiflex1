CREATE PROCEDURE `usp_ShiftDataCU`(IN in_operation varchar(50), 
  IN in_id int(11),
  IN in_department_name varchar(100) ,
  IN in_day_name varchar(40) ,
  IN in_shift_name varchar(100) ,
  IN in_shift_start int(11) ,
  IN in_shift_end int(11) ,
  IN in_break1_start int(11) ,
  IN in_break1_end int(11) ,
  IN in_break2_start int(11) ,
  IN in_break2_end int(11) ,
  IN in_break3_start int(11) ,
  IN in_break3_end int(11) 
 
 )
BEGIN
	DECLARE is_first_time INT unsigned DEFAULT 0;
	set is_first_time= (select is_first_time_run from csi_enetdata.tbl_shift_data where department_name=in_department_name and day_name=in_day_name and shift_name=in_shift_name limit 1);


	if in_operation = 'create' and is_first_time is null then
		INSERT INTO `csi_enetdata`.`tbl_shift_data`
		(
		`department_name`,
		`day_name`,
		`shift_name`,
		`shift_start`,
		`shift_end`,
		`break1_start`,
		`break1_end`,
		`break2_start`,
		`break2_end`,
		`break3_start`,
		`break3_end`,
		`log_date`,
        `is_first_time_run`)
		VALUES
		(
		in_department_name,
		in_day_name,
		in_shift_name,
		in_shift_start,
		in_shift_end,
		in_break1_start,
		in_break1_end,
		in_break2_start,
		in_break2_end,
		in_break3_start,
		in_break3_end,
		NOW(),
        1);

	else
		SET SQL_SAFE_UPDATES=0;
		UPDATE `csi_enetdata`.`tbl_shift_data`
		SET
		`department_name` = in_department_name,
		`day_name` = in_day_name,
		`shift_name` = in_shift_name,
		`shift_start` = in_shift_start,
		`shift_end` = in_shift_end,
		`break1_start` = in_break1_start,
		`break1_end` = in_break1_end,
		`break2_start` = in_break2_start,
		`break2_end` = in_break2_end,
		`break3_start` = in_break3_start,
		`break3_end` = in_break3_end,
		`log_date` = NOW()
		where department_name=in_department_name and day_name=in_day_name and shift_name=in_shift_name;


	END IF;
END